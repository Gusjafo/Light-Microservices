<div class="page-container">
  <mat-card>
    <mat-card-title>Logs del sistema</mat-card-title>
    <mat-card-content>
      <mat-button-toggle-group [(ngModel)]="selectedLevel" (change)="loadLogs()" appearance="legacy">
        <mat-button-toggle *ngFor="let level of levels" [value]="level">{{ level | titlecase }}</mat-button-toggle>
      </mat-button-toggle-group>

      <div class="table-container" *ngIf="!isLoading; else loading">
        <table mat-table [dataSource]="logs" class="full-width-table">
          <ng-container matColumnDef="timestamp">
            <th mat-header-cell *matHeaderCellDef>Fecha</th>
            <td mat-cell *matCellDef="let log">{{ log.timestamp | date:'short' }}</td>
          </ng-container>

          <ng-container matColumnDef="level">
            <th mat-header-cell *matHeaderCellDef>Nivel</th>
            <td mat-cell *matCellDef="let log">
              <mat-chip-set>
                <mat-chip [color]="log.level === 'error' ? 'warn' : log.level === 'warning' ? 'accent' : 'primary'" selected>
                  {{ log.level | uppercase }}
                </mat-chip>
              </mat-chip-set>
            </td>
          </ng-container>

          <ng-container matColumnDef="message">
            <th mat-header-cell *matHeaderCellDef>Mensaje</th>
            <td mat-cell *matCellDef="let log">{{ log.message }}</td>
          </ng-container>

          <ng-container matColumnDef="context">
            <th mat-header-cell *matHeaderCellDef>Contexto</th>
            <td mat-cell *matCellDef="let log">{{ log.context || '-' }}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="['timestamp','level','message','context']"></tr>
          <tr mat-row *matRowDef="let row; columns: ['timestamp','level','message','context']"></tr>
        </table>
      </div>
      <ng-template #loading>
        <div class="loading-container">
          <mat-spinner diameter="40"></mat-spinner>
        </div>
      </ng-template>
    </mat-card-content>
  </mat-card>
</div>
